<!--
  The 'concerto-client-time' element provides the current client side time
-->
<dom-module id="concerto-client-time">
  <style>
    #clientTime * {
      margin: 0;
    }
  </style>

  <template>
    <div id="clientTime" class="clientTime"></div>
  </template>

  <script>
    Polymer({
      is: "concerto-client-time",

      hostAttributes: {
        constructor: "ConcertoClientTime"
      },

      properties: {
        dateObj: {
          type: Object,
          value: null
        },
        config: {
          type: Object,
          value: {}
        }
      },

      /**
       * Display the current client side time
       *
       */
      domReady: function() {
        this.dateObj = new Date();
        var date = this.prepareDate();
        var time = this.prepareTime();
        this.$.clientTime.innerHTML = "<p>" + date + "<br />" + time + "</p>"
        /* Adjust font to largest size possible that fits in time field */
        Polymer.Base.optimalFontSize(this, this.$.clientTime);
      },

      /**
       * Get the current date
       *
       */
      prepareDate: function() {
        return this.dateObj.toLocaleDateString();
      },

      /**
       * Get the current time
       *
       */
      prepareTime: function() {
        var rawTime = this.dateObj.toLocaleTimeString();
        var amPm = rawTime.slice(-2);

        var hours = this.dateObj.getHours();
        hours = ((hours + 11) % 12 + 1);
        var minutes = this.dateObj.getMinutes();

        if (minutes < 10) { 
          minutes = "0" + minutes;
        }

        return hours + ":" + minutes + " " + amPm;
      }
    });
  </script>
</dom-module>
<script>
  registerContentType("concerto-client-time", "ConcertoClientTime");
</script>