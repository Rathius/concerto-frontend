<!--
  The 'concerto-client-time' element provides the current client side time
-->
<dom-module id="concerto-client-time">
  <style>
    :host { 
      position: absolute;
      width: 100%;
      height: 100%;
    }

    #clientTime * {
      margin: 0;
    }
  </style>

  <template>
    <div id="clientTime" class="clientTime"></div>
  </template>

  <script>
    ConcertoClientTime = Polymer({
      is: "concerto-client-time",

      behaviors: [ConcertoBehaviors.BaseContent, 
                  ConcertoBehaviors.Utils],

      properties: {
        dateObj: Object
      },

      /**
       * Display the current client side time
       *
       */
      attached: function() {
        this.dateObj = new Date();
        var date = this.prepareDate();
        var time = this.prepareTime();
        this.$.clientTime.innerHTML = date + "<br />" + time;
        /* Adjust font to largest size possible that fits in time field */
        this.optimalFontSize(this, this.$.clientTime);
      },

      /**
       * Get the current date
       *
       */
      prepareDate: function() {
        return this.dateObj.toLocaleDateString();
      },

      /**
       * Get the current time
       *
       */
      prepareTime: function() {
        var rawTime = this.dateObj.toLocaleTimeString();
        var amPm = rawTime.slice(-2);

        var hours = this.dateObj.getHours();
        hours = ((hours + 11) % 12 + 1);
        var minutes = this.dateObj.getMinutes();

        if (minutes < 10) { 
          minutes = "0" + minutes;
        }

        return hours + ":" + minutes + " " + amPm;
      }
    });
  </script>
</dom-module>

<script> 
  ConcertoBehaviors.ContentFactory.registerContent("concerto-client-time", "ConcertoClientTime");
</script>